rule 8base_detect {
    meta:
        author = "unixfreaxjp"
        date = "2024-09-01"
        version = "1"
        description = "win8base ransomware detection"

    strings:
        $bin0 = { 6a00 ff15???????? 8d8e04a2feff 81f98c230000 770b }
        $bin1 = { f8 290c67 98 a6 73c2 }
        $bin2 = { 8815???????? c605????????6f 880d???????? c605????????65 c605????????63 }
        $bin3 = { 8d3485c0289100 8b06 83e71f c1e706 03c7 8a5824 }
        $bin4 = { c684249c00000002 50 c7442410043a4000 e8???????? }
        $bin5 = { d3ea 89542414 8b442434 01442414 8b442424 31442410 }
        $bin6 = { ff15???????? 8b442414 40 3d???????? 89442414 0f8c0effffff 8b35???????? }
        $bin7 = { 8bf7 83e61f c1e606 033485c0289100 c745e401000000 }
        $bin8 = { 6689442416 33c9 668954241a 8d442434 50 66894c241c 8b4c241c }
        $bin9 = { 899c24ac000000 3bfb 7449 8b8424b8000000 56 8d742418 }
	$st01 = "shadowcopy delete" nocase wide ascii
	$st02 = "wbadmin delete" nocase wide ascii
	$st03 = "vssadmin delete" nocase wide ascii
	$st04 = "recoveryenabled" fullword nocase wide ascii
	$st05 = "bootstatuspolicy" fullword nocase wide ascii
	$st06 = "ignoreallfailures" fullword nocase wide ascii

    condition:
        10 of them and filesize < 12638016
    }
